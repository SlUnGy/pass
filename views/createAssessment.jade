extends layout
block content
	script.
	
		function recalculateColors(parentNode){
			var textfields = parentNode.getElementsByClassName("textfield");
			var color_jumps = 351/(textfields.length);
			var red = 99;
			var green = 255;
			var blue = 0;
			
			//Modus: Fill up red first (yellow), than reduce green to 0
			for(var i=0; i<textfields.length; i++){
				textfields[i].style.backgroundColor = "#" + Math.round(red).toString(16) + Math.round(green).toString(16) + "00";
				if(red+color_jumps > 255){
					green = green - (color_jumps-(255-red));
					red = 255;
				}
				else{
					red = red+color_jumps;
				}
			}
		}	
	
		function addSmileyToQuestion(){	
			var smileyHolder = event.target.parentNode.getElementsByClassName("smileyHolder")[0];
			if(smileyHolder.children.length < 5){
				var newSmiley = document.createElement("input"); //Create a smiley field
				newSmiley.className = "textfield";
				newSmiley.style.width = "16px";
				newSmiley.maxLength = "2";
				smileyHolder.appendChild(newSmiley);
				recalculateColors(smileyHolder);
			}
		}
		
		function removeSmileyFromQuestion(){
			var smileyHolder = event.target.parentNode.getElementsByClassName("smileyHolder")[0];
			if(smileyHolder.children.length > 2){
				smileyHolder.removeChild(smileyHolder.getElementsByClassName("textfield")[smileyHolder.children.length-1]);
				recalculateColors(smileyHolder);
			}
		}
	
		function addQuestionToAssignment(){
			var newQuestion = function(){}; //Create a placeholder object
			parentDiv = event.target.parentNode.getElementsByClassName("questionHolder")[0];
			childDiv = document.createElement("div");
			
			newQuestion.description = document.createElement("input");
			newQuestion.description.placeholder = "Question Description";
			newQuestion.description.className = "textfield";
			
			newQuestion.smileyHolder = document.createElement("span");
			newQuestion.smileyHolder.className = "smileyHolder";
			newQuestion.smileyHolder.smileys = 2; //We have to count, since we want max 5, min 2 SmileyFields
			
			newQuestion.smileyFields = {};
			newQuestion.smileyFields["0"] = document.createElement("input"); //Create first smiley field
			newQuestion.smileyFields["0"].className = "textfield";
			newQuestion.smileyFields["0"].style.width="16px";
			newQuestion.smileyFields["0"].maxLength = "2";
			newQuestion.smileyFields["0"].style.backgroundColor = "#63ff00";
			newQuestion.smileyFields["1"] = document.createElement("input"); //Create second smiley field. More can be added via '+'
			newQuestion.smileyFields["1"].className = "textfield";
			newQuestion.smileyFields["1"].style.width="16px";
			newQuestion.smileyFields["1"].maxLength = "2";
			newQuestion.smileyFields["1"].style.backgroundColor = "#ffb100";
			newQuestion.smileyHolder.appendChild(newQuestion.smileyFields["0"]); //Apend the predefined Smileys
			newQuestion.smileyHolder.appendChild(newQuestion.smileyFields["1"]);
			
			newQuestion.addQuestionButton = document.createElement("input");
			newQuestion.addQuestionButton.type = "button";
			newQuestion.addQuestionButton.className = "button";
			newQuestion.addQuestionButton.value = "+";
			newQuestion.addQuestionButton.onclick = function(){addSmileyToQuestion(this);};
			
			newQuestion.removeQuestionButton = document.createElement("input");
			newQuestion.removeQuestionButton.type = "button";
			newQuestion.removeQuestionButton.className = "button";
			newQuestion.removeQuestionButton.value = "-";
			newQuestion.removeQuestionButton.onclick = function(){removeSmileyFromQuestion(this);};
			
			placeholder =  document.createElement("label");
			placeholder.style.minWidth = "40px";
			placeholder.style.display = "inline-block";
			
			childDiv.appendChild(placeholder);
			childDiv.appendChild(newQuestion.description);
			childDiv.appendChild(newQuestion.smileyHolder);
			childDiv.appendChild(newQuestion.addQuestionButton);
			childDiv.appendChild(newQuestion.removeQuestionButton);
			childDiv.appendChild(document.createElement("br"));
			parentDiv.appendChild(childDiv);
		}
		
		function addAssignmentToList(){
			var newAssignment = function(){}; //Create a placeholder object
			var assignmentHolder = document.createElement("div");
						
			newAssignment.description = document.createElement("input");
			newAssignment.description.placeholder = "Assignment Description";
			newAssignment.description.className = "textfield";
			
			newAssignment.addQuestionButton = document.createElement("input");
			newAssignment.addQuestionButton.type = "button";
			newAssignment.addQuestionButton.className = "button";
			newAssignment.addQuestionButton.value = "Add Question";
			newAssignment.addQuestionButton.onclick = function(){addQuestionToAssignment(this);};
			
			placeholder =  document.createElement("label");
			placeholder.style.minWidth = "20px";
			placeholder.style.display = "inline-block";
			
			assignmentHolder.appendChild(placeholder);			
			assignmentHolder.appendChild(newAssignment.description);
			assignmentHolder.appendChild(newAssignment.addQuestionButton);
			assignmentHolder.appendChild(document.createElement("br"));
			
			newAssignment.questionHolder = document.createElement("div");
			newAssignment.questionHolder.id = "questionHolder";
			newAssignment.questionHolder.className = "questionHolder";
			assignmentHolder.appendChild(newAssignment.questionHolder);
			
			document.getElementById("assignmentTable").appendChild(assignmentHolder);
		}
		
	p(id="heading") Create a new assessment
	form(action="/createAssessmentDo", method="post" id="createForm")
		input(type="text", name="assessmentName", placeholder="Asessment Name", class="textfield") 
		input(type="button", name="addAssignment", value="Add Assignment", onclick="addAssignmentToList()", class="button")
		br
		#assignmentTable
		input(type="hidden", name="postStudents", id="postStudents", value="")
		input(type="submit", value="Create Course", class="button")
